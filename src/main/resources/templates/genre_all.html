<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8"/>
    <title>Жанры</title>
	<link rel="stylesheet" type="text/css" media="all" href="../static/style.css" th:href="@{/style.css}" >
    <script type="text/javascript" src="../static/scripts/common.js" th:src="@{/scripts/common.js}"></script>
</head>
<body>
<h1>Жанры:</h1>
<a th:href="@{/genres/add}" href="genre_add.html">Добавить жанр</a>
<table class="list">
    <thead>
    <tr>
        <th>ИД</th>
        <th>Наименование</th>
        <th>Действия</th>
    </tr>
    <tr>
        <th></th>
        <th>
			<form id="genre-filter-name" 
			th:action="@{/genres}" 
			th:object="${filter}" method="get">
				<div>
					<div>
						Фильтр: <input id="filter" type="text" th:field="*{name}"/>
						<input name="size" th:value="${genrePage.size}" type="hidden"/>
						<input name="page" th:value="${currentPage}" type="hidden"/>
					</div>
				</div>
			</form>		
		</th>
        <th></th>
    </tr>	
    </thead>
    <tbody>
    <tr th:each="genre, iStat : ${genrePage.content}">
        <td th:text="${genre.id}">1</td>
        <td th:text="${genre.name}">Новый жанр</td>
        <td>
            <a th:href="@{/genres/edit/{id}(id=${genre.id})}" href="genre_edit.html">Изменить</a>
        </td>
    </tr>
    </tbody>
</table>
<div th:if="${genrePage.totalPages > 0}" class="pagination" th:each="pageNumber : ${pageNumbers}">
    <a th:href="@{/genres(size=${genrePage.size}, page=${pageNumber}, name=${filter.name})}"
       th:text=${pageNumber}>
	</a>
</div>
<script>
	var filter = document.getElementById('filter');
	var filterForm = document.getElementById('genre-filter-name');
	filter.oninput = function() {
		filterForm.submit();
	};
	filter.onfocus = function() {
		Common.moveCaretToEnd(filter);
		// Work around Chrome's little problem
		window.setTimeout(function() {
			Common.moveCaretToEnd(filter);
		}, 1);
	};  
	filter.focus();
</script>
</body>
</html>
