<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8"/>
    <title>Авторы</title>
	<link rel="stylesheet" type="text/css" media="all" href="../static/style.css" th:href="@{/style.css}" >
	<script type="text/javascript" src="../static/scripts/common.js" th:src="@{/scripts/common.js}"></script>
</head>
<body>
<h1>Авторы:</h1>
<a th:href="@{/authors/add}" href="author_add.html">Добавить автора</a>
<table class="list">
    <thead>
    <tr>
        <th>ИД</th>
        <th>Фамилия</th>
		<th>Имя</th>
		<th>Отчество</th>
        <th>Действия</th>
    </tr>
    <tr>
        <th></th>
        <th colspan="3">
			<form id="author-filter-name" 
			th:action="@{/authors}" 
			th:object="${filter}" method="get">
				<div>
					<div>
						Фильтр: <input id="filter" type="text" th:field="*{name}"/>
						<input name="size" th:value="${authorPage.size}" type="hidden"/>
						<input name="page" th:value="${currentPage}" type="hidden"/>
					</div>
				</div>
			</form>		
		</th>
        <th></th>
    </tr>	
    </thead>
    <tbody>
    <tr th:each="author, iStat : ${authorPage.content}">
        <td th:text="${author.id}">1</td>
        <td th:text="${author.surname}">Писателев</td>
		<td th:text="${author.firstname}">Писаакий</td>
		<td th:text="${author.middlename}">Иванович</td>
        <td>
            <a th:href="@{/authors/{id}(id=${author.id})}" href="author_edit.html">Изменить</a>
        </td>
    </tr>
    </tbody>
</table>
<div th:if="${authorPage.totalPages > 0}" class="pagination" th:each="pageNumber : ${pageNumbers}">
    <a th:href="@{/authors(size=${authorPage.size}, page=${pageNumber}, name=${filter.name})}"
       th:text=${pageNumber}>
	</a>
</div>
<script>
	var filter = document.getElementById('filter');
	var filterForm = document.getElementById('author-filter-name');
	filter.oninput = function() {
		filterForm.submit();
	};
	filter.onfocus = function() {
		Common.moveCaretToEnd(filter);
		// Work around Chrome's little problem
		window.setTimeout(function() {
			Common.moveCaretToEnd(filter);
		}, 1);
	};  
	filter.focus();
</script>
</body>
</html>
